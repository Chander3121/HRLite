<!-- GREETING -->
<div class="mb-10">
  <h1 class="text-3xl font-semibold text-gray-900">
    <%= dashboard_greeting(current_user) %> ğŸ‘‹
  </h1>
  <p class="mt-1 text-sm text-gray-500">
    Hereâ€™s a snapshot of your journey at HRLite
  </p>
</div>

<% profile = current_user.employee_profile %>

<!-- KEY STATS -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">
  <div class="bg-white rounded-xl shadow p-6">
    <p class="text-sm text-gray-500">Employee ID</p>
    <p class="mt-1 text-xl font-semibold text-gray-900">
      <%= profile.emp_id %>
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-6">
    <p class="text-sm text-gray-500">Designation</p>
    <p class="mt-1 text-xl font-semibold text-gray-900">
      <%= profile.designation %>
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-6">
    <p class="text-sm text-gray-500">Working Since</p>
    <p class="mt-1 text-xl font-semibold text-gray-900">
      <%= profile.joining_date.strftime("%d %b %Y") %>
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-6">
    <p class="text-sm text-gray-500">Tenure</p>
    <p class="mt-1 text-xl font-semibold text-gray-900">
      <%= distance_of_time_in_words(profile.joining_date, Date.current) %>
    </p>
  </div>
</div>

<!-- LEAVE SUMMARY -->
<div class="bg-white rounded-xl shadow p-6 mb-12">
  <h2 class="text-lg font-semibold text-gray-900 mb-4">
    Leave Bucket
  </h2>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <% current_user.leave_balances.each do |balance| %>
      <div class="border rounded-lg p-4 text-center">
        <p class="text-sm text-gray-500">
          <%= balance.leave_type.titleize %>
        </p>
        <p class="text-2xl font-bold text-indigo-600">
          <%= balance.remaining %>
        </p>
        <p class="text-xs text-gray-400">
          of <%= balance.total %> days remaining
        </p>
      </div>
    <% end %>
  </div>
</div>

<!-- MARK ATTENDANCE -->
<div class="bg-white rounded-xl shadow p-6 mb-12">
  <h2 class="text-lg font-semibold text-gray-900 mb-4">
    Mark Attendance
  </h2>

  <% today = Date.current %>
  <% holiday = Holiday.find_by(date: today) %>
  <% attendance = @today_attendance || current_user.attendances.find_by(date: today) %>

  <% if @today.saturday? || @today.sunday? %>
    <!-- WEEK OFF -->
    <div class="rounded-lg bg-orange-50 px-4 py-3 text-sm text-orange-700">
      ğŸ’¤ Today is a Weekly Off (Saturday / Sunday)
    </div>

  <% elsif @holiday %>
    <!-- HOLIDAY -->
    <div class="rounded-lg bg-red-50 px-4 py-3 text-sm text-red-700">
      ğŸ‰ Holiday: <strong><%= @holiday.name %></strong>
    </div>

  <% else %>
    <!-- WORKING DAY -->
    <div class="flex flex-wrap items-center gap-4">
      <!-- CHECK IN -->
      <% if @today_attendance&.check_in.present? %>
        <button
          disabled
          class="px-4 py-2 rounded-lg bg-gray-300 text-gray-600 cursor-not-allowed">
          Checked In at <%= @today_attendance&.check_in.strftime("%I:%M %p") %>
        </button>
      <% else %>
        <%= button_to "Check In",
            check_in_attendances_path,
            method: :post,
            data: { turbo: false },
            class: "px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition" %>
      <% end %>

      <!-- CHECK OUT -->
      <% if @today_attendance&.check_in.present? && @today_attendance&.check_out.blank? %>
        <%= button_to "Check Out",
            check_out_attendances_path,
            method: :post,
            data: { turbo: false },
            class: "px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition" %>
      <% elsif @today_attendance&.check_out.present? %>
        <button
          disabled
          class="px-4 py-2 rounded-lg bg-gray-300 text-gray-600 cursor-not-allowed">
          Checked Out at <%= @today_attendance&.check_out.strftime("%I:%M %p") %>
        </button>
      <% end %>
    </div>

    <% if @today_attendance %>
      <p class="mt-4 text-sm text-gray-500">
        Status:
        <span class="font-medium text-gray-800">
          <%= @today_attendance&.status.titleize %>
        </span>
      </p>
    <% end %>
  <% end %>
</div>

<!-- ATTENDANCE & WORK -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
  <div class="bg-white rounded-xl shadow p-6">
    <h2 class="text-lg font-semibold mb-4">ğŸ“… Attendance Overview</h2>

    <p class="text-sm text-gray-500">Days Worked</p>
    <p class="text-2xl font-semibold text-gray-900">
      <%= current_user.attendances.where(status: "present").count %>
    </p>

    <p class="mt-4 text-sm text-gray-500">Total Working Days</p>
    <p class="text-xl font-semibold text-gray-900">
      <%= current_user.attendances.count %>
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-6">
    <h2 class="text-lg font-semibold mb-4">â± Work Summary</h2>

    <% total_minutes = current_user.attendances.sum(:worked_minutes) %>

    <p class="text-sm text-gray-500">Total Hours Worked</p>
    <p class="text-2xl font-semibold text-gray-900">
      <%= (total_minutes.to_f / 60).round(1) %> hrs
    </p>

    <p class="mt-4 text-sm text-gray-500">Average Hours / Day</p>
    <p class="text-xl font-semibold text-gray-900">
      <%= (total_minutes.to_f / 60 / [current_user.attendances.count, 1].max).round(1) %> hrs
    </p>
  </div>
</div>

<!-- AWARDS & RECOGNITION -->
<div class="bg-white rounded-xl shadow p-6 mb-12">
  <h2 class="text-lg font-semibold text-gray-900 mb-4">
    ğŸ† Achievements & Recognition
  </h2>

  <% if profile.respond_to?(:awards) && profile.awards.any? %>
    <ul class="list-disc pl-5 text-sm text-gray-700">
      <% profile.awards.each do |award| %>
        <li><%= award.title %> â€” <%= award.awarded_on.strftime("%b %Y") %></li>
      <% end %>
    </ul>
  <% else %>
    <p class="text-sm text-gray-500">
      No awards recorded yet. Keep going â€” great work gets noticed ğŸ‘
    </p>
  <% end %>
</div>

<!-- MOTIVATION -->
<div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-8 text-center">
  <% quotes = [
    "Your growth is as important as the companyâ€™s growth.",
    "Consistency builds careers.",
    "Great work happens one day at a time.",
    "Every contribution counts.",
    "Progress, not perfection."
  ] %>

  <p class="text-lg font-medium text-gray-800 italic">
    â€œ<%= quotes.sample %>â€
  </p>

  <p class="mt-3 text-sm text-gray-500">
    â€” HRLite
  </p>
</div>
